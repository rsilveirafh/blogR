{
  "hash": "3b8421808119defeafb36b44008fe655",
  "result": {
    "markdown": "---\ntitle: \"Cobertura de Dossel em imagens no R\"\nsubtitle: \"Explorando o pacote `{coveR}`\"\ndate: \"2022-06-21\"\ncategories: [coveR, dossel, ecologia, R, tags]\nimage: \"https://gitlab.com/fchianucci/coveR/-/raw/master/inst/extdata/coveR-logo_HR.png\"\ndraft: false\n---\n\n\n## Propósito\n\nSurgiu uma demanda no laboratório, em que precisarei tirar medidas de cobertura de dossel de cada um dos *pitfall-traps* que estão instalados em campo.\n\nPara adiantar, resolvi estudar e criar uma rotina para este propósito.\n\nAbaixo explico brevemente cada um dos passos para sua realização.\n\n\n\n\n\n\n## 1. Pacotes utilizados na sessão\n\nApós pesquisar bastante, encontrei o pacote `{coveR}`, que foi escrito pelo *Francesco Chianucci*. Você pode ter mais informações no seu artigo de lançamento: [veja aqui](https://link.springer.com/article/10.1007/s00468-022-02338-5).\n\n- Para que o `{coveR}` possa funcionar, são necessários os pacotes `{EBImage}` e `{exiftoolr}`, ver abaixo:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Repositório BiocManager:\ninstall.packages(\"BiocManager\")\n\n# Pacote {EBImage}\nBiocManager::install(\"EBImage\")\n\n# Pacote {exiftoolr} + instalação\ndevtools::install_github(\"JoshOBrien/exiftoolr\")\nexiftoolr::install_exiftool()\n\n# Pacote {coveR}\ndevtools::install_git(\"https://gitlab.com/fchianucci/coveR\")\n```\n:::\n\n> Eu penei um pouco para instalar tudo com sucesso, mas nada que algumas horas de briga com o Linux não resolvam =)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(coveR)      # imagens de cobertura\nlibrary(cowplot)    # organizar plots\nlibrary(here)       # localização de arquivos\nlibrary(kableExtra) # tabelas\nlibrary(knitr)      # tabelas/imagens\nlibrary(patchwork)  # organizar plots\nlibrary(tidyverse)  # manipulação de dados\n```\n:::\n\n\n\n\n---\n\n# 2. Dados iniciais\n\n\n### 2.1. Criar o objeto principal\n\n- Criando objeto `image`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimage <- here(\"posts/007-coveR/pics/pt03_ang.png\")\n```\n:::\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![Imagem gerada a partir de um celular com lente angular no Ponto 03.](pics/pt03_ang.png){fig-align='left' width=640}\n:::\n:::\n\n\n\n- O canal azul é preferido porque permite um maior contraste entre os pixels do céu e do dossel\n- Isso é ilustrado a seguir:\n\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![Imagem gerada a partir de um celular com lente angular no Ponto 03.](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n### 2.2. Selecionar o canal azul\n\n- Selecionar o canal azul\n- Criando objeto `img_blue`\n- Função `open_blue()` importa a imagem transformando em um raster de canal único (azul)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimg_blue <- open_blue(image, which.blue = 3, exif = FALSE, crop = NULL)\n```\n:::\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![Imagem raster feita a partir de uma banda azul.](index_files/figure-html/unnamed-chunk-8-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n### 2.3. Classificar os pixels e criar uma imagem binária\n\n- Imagem binária onde céu (*1*) e dossel (*0*)\n- A função `thd_blue()` recebe a imagem rasterizada azul e transforma em binária\n- Utiliza a função `auto_thresh()` do pacote `{autothresholdr}` para definir o thresholding (limites) da imagem \n- O padrão é o método _\"Minimum\"_, mas existem 17 métodos diferentes que podem ser testados (<https://imagej.net/plugins/auto-threshold>)\n- Criando objetos `img_lim_min` (médoto _\"Minimum\"_) e `img_lim_def` (método _\"Default\"_)\n\n\n::: {.cell layout-align=\"left\"}\n\n```{.r .cell-code}\nimg_lim_min <- thd_blue(img_blue, method = \"Minimum\", display = TRUE)\n```\n\n::: {.cell-output-display}\n![Imagem binária feita com o método \"Minimum\".](index_files/figure-html/unnamed-chunk-9-1.png){fig-align='left' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"left\"}\n\n```{.r .cell-code}\nimg_lim_def <- thd_blue(img_blue, method = \"Default\", display = TRUE)\n```\n\n::: {.cell-output-display}\n![Imagem binária feita com o método \"Default\".](index_files/figure-html/unnamed-chunk-10-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n### 2.4. Segmentar e nomear as lacunas\n\n- Retornar os atributos do dossel requer uma classificação dos pixels (os valores *1* no raster binário)\n    - largos: lacunas entre o dossel\n    - pequenos: lacunas dentro do dossel\n- A função `label_gaps()` usa a função `bwlabel()` do pacote `{EBImage}` para atribuir um valor numérico para cada lacuna distinta\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimg_min_gaps <- label_gaps(img_lim_min)\n```\n:::\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![Minimum](index_files/figure-html/unnamed-chunk-12-1.png){fig-align='left' width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nimg_def_gaps <- label_gaps(img_lim_def)\n```\n:::\n\n::: {.cell layout-align=\"left\"}\n::: {.cell-output-display}\n![Default](index_files/figure-html/unnamed-chunk-14-1.png){fig-align='left' width=672}\n:::\n:::\n\n\n\n### 2.5. Classificar lacunas baseadas no tamanho\n\nExistem basicamente dois métodos para classificar as lacunas a depender do seus tamanhos.\n\n- [Macfarlane et al., 2007](https://doi.org/10.1016/j.agrformet.2007.05.001)\n    - Considera lacunas grandes aquelas com 1,3% da área da imagem.\n- [Alivernini et al., 2018](https://doi.org/10.1007/s00468-018-1666-3)\n    - Se baseia na distribuição estatística do tamanho das lacunas dentro da imagem.\n    - Lacunas grandes são consideradas por $gL \\ge \\mu + \\sqrt{{\\sigma \\over n}}$\n    - Comparado ao método anterior, este é dependente da densidade do dossel, já que o limite das lacunas grandes vão variar a cada imagem.\n    \nOs métodos são implementados na função `extract_gap()`:\n\n- Método _\"Minimum\"_\n\n::: {.cell}\n\n```{.r .cell-code}\n# Macfarlane\ndf_min_mac <- extract_gap(img_min_gaps, gapmethod = \"macfarlane\")\nkable(head(df_min_mac))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:left;\"> Var1 </th>\n   <th style=\"text-align:right;\"> Freq </th>\n   <th style=\"text-align:right;\"> NR </th>\n   <th style=\"text-align:left;\"> gL </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:right;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:right;\"> 796127 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Canopy </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 41 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 81 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Alivernini\ndf_min_ali <- extract_gap(img_min_gaps, gapmethod = \"alivernini\")\nkable(head(df_min_ali))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:left;\"> Var1 </th>\n   <th style=\"text-align:right;\"> Freq </th>\n   <th style=\"text-align:right;\"> NR </th>\n   <th style=\"text-align:left;\"> gL </th>\n   <th style=\"text-align:right;\"> gMN </th>\n   <th style=\"text-align:right;\"> gSD </th>\n   <th style=\"text-align:right;\"> gN </th>\n   <th style=\"text-align:right;\"> gTHD </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:left;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:right;\"> 796127 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Canopy </td>\n   <td style=\"text-align:right;\"> 796127.0000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 41 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 81 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n- Método _\"Default\"_\n\n::: {.cell}\n\n```{.r .cell-code}\n# Macfarlane\ndf_def_mac <- extract_gap(img_def_gaps, gapmethod = \"macfarlane\")\nkable(head(df_min_mac))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:left;\"> Var1 </th>\n   <th style=\"text-align:right;\"> Freq </th>\n   <th style=\"text-align:right;\"> NR </th>\n   <th style=\"text-align:left;\"> gL </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:right;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:right;\"> 796127 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Canopy </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 41 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 81 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Alivernini\ndf_def_ali <- extract_gap(img_def_gaps, gapmethod = \"alivernini\")\nkable(head(df_min_ali))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:left;\"> Var1 </th>\n   <th style=\"text-align:right;\"> Freq </th>\n   <th style=\"text-align:right;\"> NR </th>\n   <th style=\"text-align:left;\"> gL </th>\n   <th style=\"text-align:right;\"> gMN </th>\n   <th style=\"text-align:right;\"> gSD </th>\n   <th style=\"text-align:right;\"> gN </th>\n   <th style=\"text-align:right;\"> gTHD </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:left;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 0 </td>\n   <td style=\"text-align:right;\"> 796127 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Canopy </td>\n   <td style=\"text-align:right;\"> 796127.0000 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 41 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:right;\"> 81 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 4 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:left;\"> 5 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1228800 </td>\n   <td style=\"text-align:left;\"> Small_gap </td>\n   <td style=\"text-align:right;\"> 114.4335 </td>\n   <td style=\"text-align:right;\"> 5130.79 </td>\n   <td style=\"text-align:right;\"> 3781 </td>\n   <td style=\"text-align:right;\"> 197.8748 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### 2.6. Recuperar atributos do dossel\n\n- Função `get_canopy()` para estimar os atributos do dossel.\n- Dentre eles:\n    - **Fração das Lacunas** ($FL$) = fração dos pixels das lacunas (nomeados por *1* na imagem binária): $FL = {Tp \\over Np}$, onde $Tp$ é o número de pixels de lacuna, $Np$ é o número total de pixels;\n    - **Cobertura Foliar** ($CF$) = complemento da fração das lacunas: $CF = {1 - FL}$;\n    - **Cobertura do Dossel** ($CD$) = complemento da fração das lacunas grandes: $CD = 1 - {Tp \\over Np}$;\n    - **Porosidade do Dossel** ($PD$) = fração das lacunas dentro dos dosséis: $PD = 1 - {CF \\over CD}$\n\nOs outros atributos podem ser verificados no artigo do [Chianucci et al.](https://link.springer.com/article/10.1007/s00468-022-02338-5).\n\n- Método _\"Minimum\"_\n\n::: {.cell}\n\n```{.r .cell-code}\n# Macfarlane\ndf2_min_mac <- get_canopy(df_min_mac)\nkable(df2_min_mac)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:right;\"> FC </th>\n   <th style=\"text-align:right;\"> CC </th>\n   <th style=\"text-align:right;\"> CP </th>\n   <th style=\"text-align:right;\"> Le </th>\n   <th style=\"text-align:right;\"> L </th>\n   <th style=\"text-align:right;\"> CI </th>\n   <th style=\"text-align:right;\"> k </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:right;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:right;\"> 0.6478898 </td>\n   <td style=\"text-align:right;\"> 0.7132389 </td>\n   <td style=\"text-align:right;\"> 0.091623 </td>\n   <td style=\"text-align:right;\"> 2.087622 </td>\n   <td style=\"text-align:right;\"> 3.409385 </td>\n   <td style=\"text-align:right;\"> 0.6123163 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Alivernini\ndf2_min_ali <- get_canopy(df_min_ali)\nkable(df2_min_ali)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:right;\"> FC </th>\n   <th style=\"text-align:right;\"> CC </th>\n   <th style=\"text-align:right;\"> CP </th>\n   <th style=\"text-align:right;\"> Le </th>\n   <th style=\"text-align:right;\"> L </th>\n   <th style=\"text-align:right;\"> CI </th>\n   <th style=\"text-align:right;\"> k </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:left;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:right;\"> 0.6478898 </td>\n   <td style=\"text-align:right;\"> 0.6785124 </td>\n   <td style=\"text-align:right;\"> 0.0451319 </td>\n   <td style=\"text-align:right;\"> 2.087622 </td>\n   <td style=\"text-align:right;\"> 4.204288 </td>\n   <td style=\"text-align:right;\"> 0.496546 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n- Método _\"Default\"_\n\n::: {.cell}\n\n```{.r .cell-code}\n# Macfarlane\ndf2_def_mac <- get_canopy(df_def_mac)\nkable(df2_def_mac)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:right;\"> FC </th>\n   <th style=\"text-align:right;\"> CC </th>\n   <th style=\"text-align:right;\"> CP </th>\n   <th style=\"text-align:right;\"> Le </th>\n   <th style=\"text-align:right;\"> L </th>\n   <th style=\"text-align:right;\"> CI </th>\n   <th style=\"text-align:right;\"> k </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:right;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:right;\"> 0.5264119 </td>\n   <td style=\"text-align:right;\"> 0.617063 </td>\n   <td style=\"text-align:right;\"> 0.1469073 </td>\n   <td style=\"text-align:right;\"> 1.494835 </td>\n   <td style=\"text-align:right;\"> 2.366996 </td>\n   <td style=\"text-align:right;\"> 0.6315324 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Default </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n\n```{.r .cell-code}\n# Alivernini\ndf2_def_ali <- get_canopy(df_def_ali)\nkable(df2_def_ali)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:right;\"> FC </th>\n   <th style=\"text-align:right;\"> CC </th>\n   <th style=\"text-align:right;\"> CP </th>\n   <th style=\"text-align:right;\"> Le </th>\n   <th style=\"text-align:right;\"> L </th>\n   <th style=\"text-align:right;\"> CI </th>\n   <th style=\"text-align:right;\"> k </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:left;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:right;\"> 0.5264119 </td>\n   <td style=\"text-align:right;\"> 0.5692228 </td>\n   <td style=\"text-align:right;\"> 0.0752093 </td>\n   <td style=\"text-align:right;\"> 1.494835 </td>\n   <td style=\"text-align:right;\"> 2.945705 </td>\n   <td style=\"text-align:right;\"> 0.5074625 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> alivernini </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> Default </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### 2.7. Comparação\n\n\n::: {.cell}\n\n:::\n\n\n\nPara efeito de comparação, abaixo estão todos os bancos de dados produzidos:\n\n::: {.cell}\n\n```{.r .cell-code}\na |>\n\tselect(methods,\n\t\t   CF = FC, \n\t\t   CD = CC, \n\t\t   PD = CP) |> \n\tkable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> methods </th>\n   <th style=\"text-align:right;\"> CF </th>\n   <th style=\"text-align:right;\"> CD </th>\n   <th style=\"text-align:right;\"> PD </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Minimum - Macfarlane </td>\n   <td style=\"text-align:right;\"> 0.6478898 </td>\n   <td style=\"text-align:right;\"> 0.7132389 </td>\n   <td style=\"text-align:right;\"> 0.0916230 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Minimum - Alivernini </td>\n   <td style=\"text-align:right;\"> 0.6478898 </td>\n   <td style=\"text-align:right;\"> 0.6785124 </td>\n   <td style=\"text-align:right;\"> 0.0451319 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Default - Macfarlane </td>\n   <td style=\"text-align:right;\"> 0.5264119 </td>\n   <td style=\"text-align:right;\"> 0.6170630 </td>\n   <td style=\"text-align:right;\"> 0.1469073 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Minimum - Alivernini </td>\n   <td style=\"text-align:right;\"> 0.5264119 </td>\n   <td style=\"text-align:right;\"> 0.5692228 </td>\n   <td style=\"text-align:right;\"> 0.0752093 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### 2.8. Programação funcional\n\nTodo o processo anterior foi realizado para apenas uma imagem, abaixo está o processo para maiores volumes de dados.\n\nEu tirei fotos de 4 pontos diferentes, em 2 formatos diferentes de câmeras:\n\n- ang: lente grande angular\n- normal: lente normal\n\nAbaixo, as imagens:\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Do lado esquerdo, as imagens feitas com câmera grande angular, à direita, com câmera normal. Pontos: 03, 10, 12, e 20](index_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\nO método utilizado foi o *Minimum*, e o método de medição de lacunas foi o *Macfarlane*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimages <- dir(path = here(\"posts/007-coveR/pics\"), pattern = \"*.png\", full.names = TRUE)\n\nimages |> \n    purrr::map(coveR, method = \"Minimum\", gapmethod = \"macfarlane\", exif = FALSE) |> \n    dplyr::bind_rows() |> \n\tkable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> id </th>\n   <th style=\"text-align:right;\"> FC </th>\n   <th style=\"text-align:right;\"> CC </th>\n   <th style=\"text-align:right;\"> CP </th>\n   <th style=\"text-align:right;\"> Le </th>\n   <th style=\"text-align:right;\"> L </th>\n   <th style=\"text-align:right;\"> CI </th>\n   <th style=\"text-align:right;\"> k </th>\n   <th style=\"text-align:left;\"> gapmethod </th>\n   <th style=\"text-align:right;\"> thd </th>\n   <th style=\"text-align:left;\"> method </th>\n   <th style=\"text-align:left;\"> channel </th>\n   <th style=\"text-align:left;\"> FileSize </th>\n   <th style=\"text-align:left;\"> Camera </th>\n   <th style=\"text-align:left;\"> Model </th>\n   <th style=\"text-align:left;\"> ImageSize </th>\n   <th style=\"text-align:left;\"> Date </th>\n   <th style=\"text-align:left;\"> day </th>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:left;\"> year </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_ang.png </td>\n   <td style=\"text-align:right;\"> 0.6478898 </td>\n   <td style=\"text-align:right;\"> 0.7132389 </td>\n   <td style=\"text-align:right;\"> 0.0916230 </td>\n   <td style=\"text-align:right;\"> 2.0876222 </td>\n   <td style=\"text-align:right;\"> 3.4093855 </td>\n   <td style=\"text-align:right;\"> 0.6123163 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt03_normal.png </td>\n   <td style=\"text-align:right;\"> 0.1219629 </td>\n   <td style=\"text-align:right;\"> 0.1371821 </td>\n   <td style=\"text-align:right;\"> 0.1109415 </td>\n   <td style=\"text-align:right;\"> 0.2601328 </td>\n   <td style=\"text-align:right;\"> 0.6032588 </td>\n   <td style=\"text-align:right;\"> 0.4312127 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt10_ang.png </td>\n   <td style=\"text-align:right;\"> 0.9079427 </td>\n   <td style=\"text-align:right;\"> 0.9834237 </td>\n   <td style=\"text-align:right;\"> 0.0767532 </td>\n   <td style=\"text-align:right;\"> 4.7706883 </td>\n   <td style=\"text-align:right;\"> 5.0492110 </td>\n   <td style=\"text-align:right;\"> 0.9448384 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt10_normal.png </td>\n   <td style=\"text-align:right;\"> 0.9001671 </td>\n   <td style=\"text-align:right;\"> 1.0000000 </td>\n   <td style=\"text-align:right;\"> 0.0998329 </td>\n   <td style=\"text-align:right;\"> 4.6085150 </td>\n   <td style=\"text-align:right;\"> 4.6085150 </td>\n   <td style=\"text-align:right;\"> 1.0000000 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt12_ang.png </td>\n   <td style=\"text-align:right;\"> 0.8985213 </td>\n   <td style=\"text-align:right;\"> 1.0000000 </td>\n   <td style=\"text-align:right;\"> 0.1014787 </td>\n   <td style=\"text-align:right;\"> 4.5758131 </td>\n   <td style=\"text-align:right;\"> 4.5758131 </td>\n   <td style=\"text-align:right;\"> 1.0000000 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt12_normal.png </td>\n   <td style=\"text-align:right;\"> 0.9081239 </td>\n   <td style=\"text-align:right;\"> 1.0000000 </td>\n   <td style=\"text-align:right;\"> 0.0918761 </td>\n   <td style=\"text-align:right;\"> 4.7746290 </td>\n   <td style=\"text-align:right;\"> 4.7746290 </td>\n   <td style=\"text-align:right;\"> 1.0000000 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt20_ang.png </td>\n   <td style=\"text-align:right;\"> 0.6560661 </td>\n   <td style=\"text-align:right;\"> 0.7758553 </td>\n   <td style=\"text-align:right;\"> 0.1543963 </td>\n   <td style=\"text-align:right;\"> 2.1346115 </td>\n   <td style=\"text-align:right;\"> 2.8989559 </td>\n   <td style=\"text-align:right;\"> 0.7363380 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> pt20_normal.png </td>\n   <td style=\"text-align:right;\"> 0.5302192 </td>\n   <td style=\"text-align:right;\"> 0.6309549 </td>\n   <td style=\"text-align:right;\"> 0.1596559 </td>\n   <td style=\"text-align:right;\"> 1.5109781 </td>\n   <td style=\"text-align:right;\"> 2.3152690 </td>\n   <td style=\"text-align:right;\"> 0.6526145 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> macfarlane </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:left;\"> Minimum </td>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:left;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n---\n\n# 3. Resumo\n\nNeste post, mostrei como:\n\n- Fazer upload de imagens para o R;\n- Rasterizar imagens;\n- Transformar imagens rasterizadas para um formato binário;\n- Transformar e classificar lacunas;\n- Recuperar atributos de dossel através do pixelamento de imagens;\n- Fazer o processo em lotes (batch).\n\nQualquer dúvida, basta entrar em contato ;)\n\n\n# 4. Referências\n\nChianucci et al. 2022. coveR: an R package for processing digital cover photography images to retrieve forest canopy attributes. **Trees**, 1-10.\n\n- Link: <https://link.springer.com/article/10.1007/s00468-022-02338-5>\n- GitLab: <https://gitlab.com/fchianucci/coveR>\n\nAlivernini, A., Fares, S., Ferrara, C. *et al.* 2018. An objective image analysis method for estimation of canopy attributes from digital cover photography. **Trees** 32, 713–723. \n\nMacfarlane, Craig; Grigg, Andrew; Crystelle Evangelista. 2007. Estimating forest leaf area using cover and fullframe fisheye photography: Thinking inside the circle. **Agricultural and Forest Meteorology** 146, 1–2: 1-12.\n\n\n\nR.",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}