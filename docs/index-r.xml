<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>#blogR</title>
<link>https://rsilveirafh.netlify.app/index.html#category=R</link>
<atom:link href="https://rsilveirafh.netlify.app/index-r.xml" rel="self" type="application/rss+xml"/>
<description>%>%ing the World</description>
<generator>quarto-1.1.251</generator>
<lastBuildDate>Tue, 18 Oct 2022 03:00:00 GMT</lastBuildDate>
<item>
  <title>Como e porqu√™ usar o pipe ( %>% e |> )?</title>
  <dc:creator>Ricardo</dc:creator>
  <link>https://rsilveirafh.netlify.app/posts/005-pipe/index.html</link>
  <description><![CDATA[ 




<section id="sobre-o-que-√©-essa-postagem" class="level2">
<h2 class="anchored" data-anchor-id="sobre-o-que-√©-essa-postagem">Sobre o que √© essa postagem?</h2>
<ul>
<li>Demonstrar o conceito de <em>tidy data</em>.</li>
<li>Utilizar o <em>pipe</em> (<code>%&gt;%</code> e <code>|&gt;</code>).</li>
</ul>
</section>
<section id="hist√≥ria" class="level2">
<h2 class="anchored" data-anchor-id="hist√≥ria">Hist√≥ria</h2>
<p>Dado que este blog √© dedicado para pessoas em quaiquer n√≠vel de aprendizado em <code>R</code>, resolvi fazer uma s√©rie de posts explicando fun√ß√µes b√°sicas para a manipula√ß√£o de dados.</p>
<p>Considero a linguagem <code>R</code> bastante objetiva na sua sintaxe b√°sica, e a forma de estrutura√ß√£o desenvolvida pelo <a href="https://twitter.com/hadleywickham">Hadley</a> e equipe, o <a href="https://vita.had.co.nz/papers/tidy-data.html"><em>tidy data</em></a>, torna a linguagem ainda mais ‚Äúsimples‚Äù para que n√≥s, meros mortais, possamos entend√™-la.</p>
<p>O <em>tidy data</em>, basicamente, √© a padroniza√ß√£o dos bancos de dados. Para que seja considerado <em>tidy</em>, o banco de dados obedecer as seguintes regras:</p>
<ol type="1">
<li>Cada <strong>coluna</strong> √© uma <u>vari√°vel</u>;</li>
<li>Cada <strong>linha</strong> √© uma <u>observa√ß√£o</u>;</li>
<li>Cada <strong>c√©lula</strong> possui somente um valor.</li>
</ol>
<p>O ant√¥nimo de uma tabela <em>tidy</em>, √© uma tabela <em>messy</em> (do ingl√™s, bagun√ßada).</p>
<hr>
<p>O dia-a-dia de um errez√™iro √© uma jornada de pegar dados ‚Äúcrus‚Äù (<em>raw</em>) e transform√°-los em dados limpos e utiliz√°veis. Nessa jornada, s√£o realizadas transforma√ß√µes de vari√°veis, filtragens, sum√°rios, etc.</p>
<p>Para uma melhor leitura dos c√≥digos por n√≥s, seres humanes, foi desenvolvido o operador <em>pipe</em> <code>%&gt;%</code>. O <em>pipe</em> desse formato t√™m sido usado h√° algum tempo no pacote <code>magrittr</code>, e sua fun√ß√£o √© unir uma sequ√™ncia de fun√ß√µes, pegando o resultado anterior, e utilizando na pr√≥xima linha.</p>
<blockquote class="blockquote">
<p>Desde a vers√£o R 4.1, o R estabeleceu o uso de um <em>pipe</em> pr√≥prio, embutido no seu c√≥digo fonte, √© o <code>|&gt;</code>. Existem algumas diferen√ßas na forma que o R l√™ ambos, mas isso fica para outro post.</p>
</blockquote>
<p>Para ilustrar, utilizarei os passos para fazer um bolo:</p>
<ol start="0" type="1">
<li>Juntar ingredientes</li>
<li>Assar;</li>
<li>Mexer;</li>
<li>Decorar;</li>
<li>Cortar;</li>
<li>Servir.</li>
</ol>
<p>Na sintaxe do <code>R</code> base, essa seria a forma de utiliza√ß√£o:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">servir</span>(<span class="fu" style="color: #4758AB;">cortar</span>(<span class="fu" style="color: #4758AB;">decorar</span>(<span class="fu" style="color: #4758AB;">assar</span>(<span class="fu" style="color: #4758AB;">mexer</span>(ingredientes)))))</span>
<span id="cb1-2"></span>
<span id="cb1-3">   <span class="dv" style="color: #AD0000;">5</span>  (  <span class="dv" style="color: #AD0000;">4</span>   (   <span class="dv" style="color: #AD0000;">3</span>   (  <span class="dv" style="color: #AD0000;">2</span>  (  <span class="dv" style="color: #AD0000;">1</span>  (     <span class="dv" style="color: #AD0000;">0</span>      )))))</span></code></pre></div>
</div>
<p>Ou seja,</p>
<ol start="0" type="1">
<li>Juntamos os ingredientes;</li>
<li>Mexemos 0;</li>
<li>Assamos o resultado de 1;</li>
<li>Decoramos o resultado de 2;</li>
<li>Cortamos o resultado de 3;</li>
<li>Servimos o resultado de 4.</li>
</ol>
<hr>
<p>Por√©m, utilizando o <em>pipe</em>, o c√≥digo ficaria assim:</p>
<blockquote class="blockquote">
<p>O atalho de teclado para o pipe √© <code>CONTROL + SHIFT + M</code>.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">ingredientes <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb2-2">    <span class="fu" style="color: #4758AB;">mexer</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb2-3">    <span class="fu" style="color: #4758AB;">assar</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb2-4">    <span class="fu" style="color: #4758AB;">decorar</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb2-5">    <span class="fu" style="color: #4758AB;">cortar</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb2-6">    <span class="fu" style="color: #4758AB;">servir</span>()</span></code></pre></div>
</div>
<p>Ou, ilustrando:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://rsilveirafh.netlify.app/posts/005-pipe/baking.gif" class="img-fluid"></p>
</div>
</div>
<p>Na hora que estamos trabalhando com dados reais, isso faz uma grande diferen√ßa.</p>
</section>
<section id="m√£os-no-r" class="level2">
<h2 class="anchored" data-anchor-id="m√£os-no-r">M√£os no R</h2>
<p>Para melhor ilustrar, vamos fazer umas manipula√ß√µes simples em uns bancos de dados, utilizando 3 m√©todos diferentes: <em>aninhado</em>, <em>objetos m√∫ltiplos</em> e <em>pipes</em>.</p>
<p>O objetivo √©:</p>
<ol type="1">
<li>Carregar o banco de dados <code>starwars</code>;</li>
<li>Filtrar por indiv√≠duos com <em>altura</em> <u>maior que 150cm</u>;</li>
<li>Agrupar por <em>especie</em> e por <em>g√™nero</em>;</li>
<li>Sumariar pela <u>m√©dia</u>;</li>
<li>Ordenar do valor <em>maior</em> para o <em>menor.</em></li>
</ol>
<blockquote class="blockquote">
<p>Utilizarei o banco de dados <code>starwars</code>, inclu√≠do no pacote <code>dados</code>. Saiba mais sobre o pacote e a iniciativa aqui: <a href="https://cienciadedatos.github.io/dados/">https://cienciadedatos.github.io/dados/</a></p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;"># para instalar o pacote pelo GitHub:</span></span>
<span id="cb3-2">remotes<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">install_github</span>(<span class="st" style="color: #20794D;">"cienciadedatos/dados"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;"># para instalar o pacote pelo CRAN:</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;">install.packages</span>(<span class="st" style="color: #20794D;">"dados"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;"># para carregar os pacotes:</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;">library</span>(dados)</span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;"># para carregar o banco de dados `dados_starwars`, e ver um sum√°rio</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;">glimpse</span>(dados_starwars)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 87
Columns: 14
$ nome            &lt;chr&gt; "Luke Skywalker", "C-3PO", "R2-D2", "Darth Vader", "Le‚Ä¶
$ altura          &lt;int&gt; 172, 167, 96, 202, 150, 178, 165, 97, 183, 182, 188, 1‚Ä¶
$ massa           &lt;dbl&gt; 77.0, 75.0, 32.0, 136.0, 49.0, 120.0, 75.0, 32.0, 84.0‚Ä¶
$ cor_do_cabelo   &lt;chr&gt; "Loiro", NA, NA, "Nenhum", "Castanho", "Castanho, Cinz‚Ä¶
$ cor_da_pele     &lt;chr&gt; "Branca clara", "Ouro", "Branca, Azul", "Branca", "Cla‚Ä¶
$ cor_dos_olhos   &lt;chr&gt; "Azul", "Amarelo", "Vermelho", "Amarelo", "Castanho", ‚Ä¶
$ ano_nascimento  &lt;dbl&gt; 19.0, 112.0, 33.0, 41.9, 19.0, 52.0, 47.0, NA, 24.0, 5‚Ä¶
$ sexo_biologico  &lt;chr&gt; "Macho", "Nenhum", "Nenhum", "Macho", "F√™mea", "Macho"‚Ä¶
$ genero          &lt;chr&gt; "Masculino", "Masculino", "Masculino", "Masculino", "F‚Ä¶
$ planeta_natal   &lt;chr&gt; "Tatooine", "Tatooine", "Naboo", "Tatooine", "Alderaan‚Ä¶
$ especie         &lt;chr&gt; "Humano", "Droide", "Droide", "Humano", "Humano", "Hum‚Ä¶
$ filmes          &lt;list&gt; &lt;"The Empire Strikes Back", "Revenge of the Sith", "R‚Ä¶
$ veiculos        &lt;list&gt; &lt;"Snowspeeder", "Imperial Speeder Bike"&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;,‚Ä¶
$ naves_espaciais &lt;list&gt; &lt;"X-wing", "Imperial shuttle"&gt;, &lt;&gt;, &lt;&gt;, "TIE Advanced‚Ä¶</code></pre>
</div>
</div>
<p><strong><u>Aninhado</u></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;">arrange</span>(</span>
<span id="cb7-2">    <span class="fu" style="color: #4758AB;">summarise</span>(</span>
<span id="cb7-3">        <span class="fu" style="color: #4758AB;">group_by</span>(</span>
<span id="cb7-4">            <span class="fu" style="color: #4758AB;">filter</span>(dados_starwars, altura <span class="sc" style="color: #5E5E5E;">&gt;</span> <span class="dv" style="color: #AD0000;">150</span>), </span>
<span id="cb7-5">            genero), </span>
<span id="cb7-6">        <span class="at" style="color: #657422;">media_massa =</span> <span class="fu" style="color: #4758AB;">mean</span>(massa, <span class="at" style="color: #657422;">na.rm =</span> <span class="cn" style="color: #8f5902;">TRUE</span>)),</span>
<span id="cb7-7">    <span class="fu" style="color: #4758AB;">desc</span>(media_massa))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
  genero    media_massa
  &lt;chr&gt;           &lt;dbl&gt;
1 Masculino       119. 
2 Feminino         55.4
3 &lt;NA&gt;             48  </code></pre>
</div>
</div>
<p><strong><u>Objetos m√∫ltiplos</u></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">a <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">filter</span>(dados_starwars, altura <span class="sc" style="color: #5E5E5E;">&gt;</span> <span class="dv" style="color: #AD0000;">150</span>)</span>
<span id="cb9-2">b <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">group_by</span>(a, genero)</span>
<span id="cb9-3">c <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">summarise</span>(b, <span class="at" style="color: #657422;">media_massa =</span> <span class="fu" style="color: #4758AB;">mean</span>(massa, <span class="at" style="color: #657422;">na.rm =</span> <span class="cn" style="color: #8f5902;">TRUE</span>))</span>
<span id="cb9-4">d <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">arrange</span>(c, <span class="fu" style="color: #4758AB;">desc</span>(media_massa))</span>
<span id="cb9-5">d</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
  genero    media_massa
  &lt;chr&gt;           &lt;dbl&gt;
1 Masculino       119. 
2 Feminino         55.4
3 &lt;NA&gt;             48  </code></pre>
</div>
</div>
<p><strong><u>Pipe <code>magrittr</code></u></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">dados_starwars <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb11-2">    <span class="fu" style="color: #4758AB;">filter</span>(altura <span class="sc" style="color: #5E5E5E;">&gt;</span> <span class="dv" style="color: #AD0000;">150</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb11-3">    <span class="fu" style="color: #4758AB;">group_by</span>(genero) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb11-4">    <span class="fu" style="color: #4758AB;">summarise</span>(<span class="at" style="color: #657422;">media_massa =</span> <span class="fu" style="color: #4758AB;">mean</span>(massa, <span class="at" style="color: #657422;">na.rm =</span> <span class="cn" style="color: #8f5902;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb11-5">    <span class="fu" style="color: #4758AB;">arrange</span>(<span class="fu" style="color: #4758AB;">desc</span>(media_massa))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
  genero    media_massa
  &lt;chr&gt;           &lt;dbl&gt;
1 Masculino       119. 
2 Feminino         55.4
3 &lt;NA&gt;             48  </code></pre>
</div>
</div>
<p><strong><u>Pipe R <code>base</code></u></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">dados_starwars <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb13-2">    <span class="fu" style="color: #4758AB;">filter</span>(altura <span class="sc" style="color: #5E5E5E;">&gt;</span> <span class="dv" style="color: #AD0000;">150</span>) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb13-3">    <span class="fu" style="color: #4758AB;">group_by</span>(genero) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb13-4">    <span class="fu" style="color: #4758AB;">summarise</span>(<span class="at" style="color: #657422;">media_massa =</span> <span class="fu" style="color: #4758AB;">mean</span>(massa, <span class="at" style="color: #657422;">na.rm =</span> <span class="cn" style="color: #8f5902;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;">|&gt;</span> </span>
<span id="cb13-5">    <span class="fu" style="color: #4758AB;">arrange</span>(<span class="fu" style="color: #4758AB;">desc</span>(media_massa))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
  genero    media_massa
  &lt;chr&gt;           &lt;dbl&gt;
1 Masculino       119. 
2 Feminino         55.4
3 &lt;NA&gt;             48  </code></pre>
</div>
</div>
</section>
<section id="finalizando" class="level2">
<h2 class="anchored" data-anchor-id="finalizando">Finalizando</h2>
<p>Eu sou super f√£ do pipe <code>magrittr</code> <code>%&gt;%</code>, e estou tentando me acostumar com o pipe built-in do R <code>|&gt;</code>, para melhorar a performance de meus c√≥digos.</p>
<p>As formas aninhadas e de m√∫ltiplos objetos utilizei bastante enquanto aprendia a linguagem, mas dificilmente as utilizo hoje em dia.</p>
<p>E ent√£o, qual forma de programar em <code>R</code> voc√™ prefere?</p>
<p>At√© a pr√≥xima!</p>
<p>Cheers,</p>
<ol start="18" type="A">
<li></li>
</ol>


</section>

 ]]></description>
  <category>ensinandoR</category>
  <category>pipe</category>
  <category>pt-br</category>
  <category>R</category>
  <category>tidyverse</category>
  <guid>https://rsilveirafh.netlify.app/posts/005-pipe/index.html</guid>
  <pubDate>Tue, 18 Oct 2022 03:00:00 GMT</pubDate>
  <media:content url="https://magrittr.tidyverse.org/logo.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Explorando o mundo de The Office</title>
  <dc:creator>Ricardo</dc:creator>
  <link>https://rsilveirafh.netlify.app/posts/004-explorando-the-office/index.html</link>
  <description><![CDATA[ 




<section id="sobre-o-que-√©-essa-postagem" class="level2">
<h2 class="anchored" data-anchor-id="sobre-o-que-√©-essa-postagem">Sobre o que √© essa postagem?</h2>
<ul>
<li>A melhor s√©rie de todos os tempos;</li>
<li>Importando dados da internet;</li>
<li>Coletando algumas informa√ß√µes utilizando <code>dplyr</code>.</li>
</ul>
</section>
<section id="hist√≥ria" class="level2">
<h2 class="anchored" data-anchor-id="hist√≥ria">Hist√≥ria</h2>
<p>Estava eu pensando sobre uma nova postagem para o blog, quando recebi no meu telefone uma notifica√ß√£o do <a href="https://www.reddit.com/r/datasets/comments/6yt3og/every_line_from_every_episode_of_the_office_us/">reddit</a>, com o t√≠tulo ‚Äú<em>Every line from Every Episode of ‚ÄòThe Office (US)‚Äô</em>‚Äù ‚Äì <em>Todas as falas de todos os epis√≥dios do The Office (EUA)</em>. Sem pensar duas vezes, fui dar uma olhada.</p>
<p>Explicando:</p>
<p>Nos idos de 2009 tive a felicidade de conhecer <a href="https://pt.wikipedia.org/wiki/The_Office_(Estados_Unidos)">The Office</a>, que se trata de uma s√©rie de com√©dia em formato de pseudodocument√°rio exibida pela rede estadunidense NBC (No Brasil d√° pra assistir pela <a href="https://www.amazon.com.br/prime">prime</a>, beb√™s üòò. Esta √© minha s√©rie favorita do cora√ß√£o (ü¶Ü Boy, Camura, Sarah).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-gif1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/004-explorando-the-office/https:/media.giphy.com/media/IwAZ6dvvvaTtdI8SD5/giphy.gif" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Yeah baby!</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Voltando:</p>
<p>Ap√≥s checar do que se tratava o banco de dados (BD), resolvi trazer pra c√°, e mexer um pouco s√≥ pra ver o que conseguimos extrair dele.</p>
<p>Pensei em mostrar somente uma breve manipula√ß√£o de dados agora, depois podemos transformar essas tabelas em belos gr√°ficos üòâ.</p>
</section>
<section id="m√£os-no-computador" class="level2">
<h2 class="anchored" data-anchor-id="m√£os-no-computador">M√£os no computador</h2>
<p>Por primeiro, devemos fazer o download dos dados. H√°, pelo menos, tr√™s formas diferentes de fazer isso:</p>
<ol type="1">
<li>Utilizando o pr√≥prio BD cedido pelo usu√°rio <a href="https://www.reddit.com/user/misunderstoodpoetry/">misunderstoodpoetry</a>.</li>
</ol>
<ul>
<li>Os dados est√£o em uma planilha do google sheets;</li>
<li>Para ter acesso pelo R, podemos utilizar o pacote <code>googlesheets4</code>, atrav√©s da fun√ß√£o <code>read_sheet()</code>, dessa forma:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;"># carregando o pacote necess√°rio</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(googlesheets4) <span class="co" style="color: #5E5E5E;"># ler diretamente do google sheets</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;"># colocando o BD em um objeto do tipo dataframe (ou tibble)</span></span>
<span id="cb1-5">theoffice <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">read_sheet</span>(<span class="st" style="color: #20794D;">"https://docs.google.com/spreadsheets/d/18wS5AAwOh8QO95RwHLS95POmSNKA2jjzdt0phrxeAE0/edit#gid=747974534"</span>)</span></code></pre></div>
</div>
<ol start="2" type="1">
<li>Utilizando o BD fornecido pelo usu√°rio <a href="https://www.kaggle.com/fabriziocominetti">Fabrizio Cominetti</a>, l√° no <a href="https://www.kaggle.com/datasets/fabriziocominetti/the-office-lines">Kaggle</a> (em outro post trago mais detalhes sobre);</li>
</ol>
<ul>
<li>Podemos fazer o download do BD utilizando uma API do Kaggle, utilizando o pacote <a href="https://github.com/mkearney/kaggler"><code>kaggler</code></a>;</li>
</ul>
<ol start="3" type="1">
<li>Baixando os dados manualmente.</li>
</ol>
<ul>
<li>Para ler o arquivo utilizarei o pacote <code>readr</code>, da fam√≠lia <code>tidyverse</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;"># carregando os pacotes necess√°rios</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr) <span class="co" style="color: #5E5E5E;"># manipula√ß√£o de dados</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;">library</span>(readr) <span class="co" style="color: #5E5E5E;"># fun√ß√£o read_csv()</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;"># lendo o arquivo "the-office_lines.csv.zip"</span></span>
<span id="cb2-6">theoffice <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">read_csv</span>(here<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">here</span>(<span class="st" style="color: #20794D;">"posts/004-explorando-the-office/the-office-lines - scripts.csv"</span>),</span>
<span id="cb2-7">                      <span class="at" style="color: #657422;">show_col_types =</span> <span class="cn" style="color: #8f5902;">FALSE</span>)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;"># resumindo os dados</span></span>
<span id="cb2-10"><span class="fu" style="color: #4758AB;">glimpse</span>(theoffice)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 59,909
Columns: 7
$ id        &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1‚Ä¶
$ season    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ‚Ä¶
$ episode   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ‚Ä¶
$ scene     &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 5, 6, 7, 7, ‚Ä¶
$ line_text &lt;chr&gt; "All right Jim. Your quarterlies look very good. How are thi‚Ä¶
$ speaker   &lt;chr&gt; "Michael", "Jim", "Michael", "Jim", "Michael", "Michael", "M‚Ä¶
$ deleted   &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS‚Ä¶</code></pre>
</div>
</div>
<p>Como podemos ver, o objeto <code>theoffice</code> cont√©m <strong>7 vari√°veis</strong> e <strong>59.909 observa√ß√µes</strong> (ou ‚Äúfalas‚Äù dos personagens).</p>
<p>Para melhor visualiza√ß√£o (somente das 6 primeiras observa√ß√µes):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">knitr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">kable</span>(<span class="fu" style="color: #4758AB;">head</span>(theoffice, <span class="at" style="color: #657422;">n =</span> <span class="dv" style="color: #AD0000;">6</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 92%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">season</th>
<th style="text-align: right;">episode</th>
<th style="text-align: right;">scene</th>
<th style="text-align: left;">line_text</th>
<th style="text-align: left;">speaker</th>
<th style="text-align: left;">deleted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">All right Jim. Your quarterlies look very good. How are things at the library?</td>
<td style="text-align: left;">Michael</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Oh, I told you. I couldn‚Äôt close it. So‚Ä¶</td>
<td style="text-align: left;">Jim</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">So you‚Äôve come to the master for guidance? Is this what you‚Äôre saying, grasshopper?</td>
<td style="text-align: left;">Michael</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Actually, you called me in here, but yeah.</td>
<td style="text-align: left;">Jim</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">All right. Well, let me show you how it‚Äôs done.</td>
<td style="text-align: left;">Michael</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">[on the phone] Yes, I‚Äôd like to speak to your office manager, please. Yes, hello. This is Michael Scott. I am the Regional Manager of Dunder Mifflin Paper Products. Just wanted to talk to you manager-a-manger. [quick cut scene] All right. Done deal. Thank you very much, sir. You‚Äôre a gentleman and a scholar. Oh, I‚Äôm sorry. OK. I‚Äôm sorry. My mistake. [hangs up] That was a woman I was talking to, so‚Ä¶ She had a very low voice. Probably a smoker, so‚Ä¶ [Clears throat] So that‚Äôs the way it‚Äôs done.</td>
<td style="text-align: left;">Michael</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/004-explorando-the-office/https:/media.giphy.com/media/5wWf7H89PisM6An8UAU/giphy.gif" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">T√° bom, Michael.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="renomeando-as-vari√°veis-para-pt-br" class="level4">
<h4 class="anchored" data-anchor-id="renomeando-as-vari√°veis-para-pt-br">Renomeando as vari√°veis para pt-br</h4>
<p>Agora, j√° que √© uma postagem em portugu√™s, vamos traduzir os nomes das vari√°veis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">theoffice_pt <span class="ot" style="color: #003B4F;">&lt;-</span> theoffice <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb5-2">    <span class="fu" style="color: #4758AB;">rename</span>(<span class="at" style="color: #657422;">temporada =</span> season,</span>
<span id="cb5-3">           <span class="at" style="color: #657422;">episodio =</span> episode,</span>
<span id="cb5-4">           <span class="at" style="color: #657422;">cena =</span> scene,</span>
<span id="cb5-5">           <span class="at" style="color: #657422;">fala =</span> line_text,</span>
<span id="cb5-6">           <span class="at" style="color: #657422;">personagem =</span> speaker,</span>
<span id="cb5-7">           <span class="at" style="color: #657422;">deletado =</span> deleted)</span>
<span id="cb5-8"></span>
<span id="cb5-9">knitr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">kable</span>(<span class="fu" style="color: #4758AB;">head</span>(theoffice_pt, <span class="at" style="color: #657422;">n =</span> <span class="dv" style="color: #AD0000;">2</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 62%">
<col style="width: 8%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">temporada</th>
<th style="text-align: right;">episodio</th>
<th style="text-align: right;">cena</th>
<th style="text-align: left;">fala</th>
<th style="text-align: left;">personagem</th>
<th style="text-align: left;">deletado</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">All right Jim. Your quarterlies look very good. How are things at the library?</td>
<td style="text-align: left;">Michael</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Oh, I told you. I couldn‚Äôt close it. So‚Ä¶</td>
<td style="text-align: left;">Jim</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Nomes das vari√°veis alteradas.</p>
</section>
<section id="n√∫mero-de-falas-por-temporada" class="level4">
<h4 class="anchored" data-anchor-id="n√∫mero-de-falas-por-temporada">N√∫mero de falas por temporada</h4>
<p>Bom, dessa vez vamos ver <strong>quantas falas existiram em cada uma das 9 temporadas da s√©rie</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">theoffice_pt <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-2">    <span class="co" style="color: #5E5E5E;"># agrupando por temporada</span></span>
<span id="cb6-3">    <span class="fu" style="color: #4758AB;">group_by</span>(temporada) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb6-4">    <span class="co" style="color: #5E5E5E;"># somando as observa√ß√µes</span></span>
<span id="cb6-5">    <span class="fu" style="color: #4758AB;">tally</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 √ó 2
  temporada     n
      &lt;dbl&gt; &lt;int&gt;
1         1  1996
2         2  7492
3         3  7483
4         4  5642
5         5  8170
6         6  7630
7         7  7302
8         8  7083
9         9  7111</code></pre>
</div>
</div>
<p>A fun√ß√£o <code>tally()</code> faz uma soma do n√∫mero de vezes que certo <em>grupo</em> aparece, dada na fun√ß√£o <code>group_by()</code>. Nesse exemplo acima, ele pega cada um dos grupos dentro de temporada, e identifica quantas observa√ß√µes h√° em cada uma.</p>
<p>A temporada que teve mais falas foi a <strong>5¬™</strong> (que, inclusive, considero a melhor!), com <strong>8170 falas</strong>.</p>
</section>
<section id="n√∫mero-de-falas-por-personagem-no-1¬∫-epis√≥dio" class="level4">
<h4 class="anchored" data-anchor-id="n√∫mero-de-falas-por-personagem-no-1¬∫-epis√≥dio">N√∫mero de falas por personagem no 1¬∫ epis√≥dio</h4>
<p>Podemos tamb√©m filtrar algumas informa√ß√µes, para ser mais espec√≠ficos. Por exemplo, se quisermos saber quantas <strong>falas</strong> foram feitas <strong>por personagem</strong> no <strong>primeiro epis√≥dio</strong> da <strong>primeira temporada</strong> (<del>a mais odiada</del>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">theoffice_pt <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb8-2">    <span class="co" style="color: #5E5E5E;"># filtramos a temporada 1 e o epis√≥dio 1</span></span>
<span id="cb8-3">    <span class="fu" style="color: #4758AB;">filter</span>(temporada <span class="sc" style="color: #5E5E5E;">==</span> <span class="dv" style="color: #AD0000;">1</span> <span class="sc" style="color: #5E5E5E;">&amp;</span> episodio <span class="sc" style="color: #5E5E5E;">==</span> <span class="dv" style="color: #AD0000;">1</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb8-4">    <span class="co" style="color: #5E5E5E;"># agrupamos por personagem</span></span>
<span id="cb8-5">    <span class="fu" style="color: #4758AB;">group_by</span>(personagem) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb8-6">    <span class="co" style="color: #5E5E5E;"># fazemos a somat√≥ria de observa√ß√µes</span></span>
<span id="cb8-7">    <span class="fu" style="color: #4758AB;">tally</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb8-8">    <span class="co" style="color: #5E5E5E;"># organizando do n√∫mero maior para o menor</span></span>
<span id="cb8-9">    <span class="fu" style="color: #4758AB;">arrange</span>(<span class="fu" style="color: #4758AB;">desc</span>(n))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 √ó 2
   personagem                  n
   &lt;chr&gt;                   &lt;int&gt;
 1 Michael                    97
 2 Pam                        46
 3 Jim                        37
 4 Dwight                     35
 5 Jan                        12
 6 Ryan                       10
 7 Oscar                       6
 8 Angela                      5
 9 Roy                         5
10 Stanley                     5
11 Documentary Crew Member     3
12 Todd Packer                 3
13 Kevin                       2
14 Phyllis                     2
15 Man                         1
16 Michel                      1</code></pre>
</div>
</div>
</section>
</section>
<section id="finalizando" class="level2">
<h2 class="anchored" data-anchor-id="finalizando">Finalizando</h2>
<p>Acho que j√° deu pra dar uma breve ideia do que conseguimos fazer com algumas poucas fun√ß√µes, em breve vamos explorar um pouco mais esses dados, e tamb√©m brincar com visualiza√ß√µes.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/004-explorando-the-office/https:/media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">√â festa!</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Nesta sess√£o apresentei os seguintes pacotes:</p>
<ul>
<li><code>dplyr</code></li>
<li><code>googlesheets4</code></li>
<li><code>readr</code></li>
</ul>
<p>At√© mais!</p>
<p>Cheers,</p>
<ol start="18" type="A">
<li></li>
</ol>
<p>Adendo: O Felipe Magalh√£es me sugeriu ver quantas vezes falaram ‚Äú<em>That‚Äôs what she said!</em>‚Äù na s√©rie, n√£o aguentei de curiosidade. A√≠ est√°:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;"># pacote para tratar com strings, tamb√©m do tidyverse</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;">library</span>(stringr)</span>
<span id="cb10-3"></span>
<span id="cb10-4">twss <span class="ot" style="color: #003B4F;">&lt;-</span> theoffice_pt <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb10-5">    <span class="co" style="color: #5E5E5E;"># filtrando as falas que cont√©m a famigerada frase</span></span>
<span id="cb10-6">    <span class="fu" style="color: #4758AB;">filter</span>(<span class="fu" style="color: #4758AB;">str_detect</span>(fala, <span class="st" style="color: #20794D;">"[Tt]hat's what she said?"</span>))</span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="fu" style="color: #4758AB;">glimpse</span>(twss)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 35
Columns: 7
$ id         &lt;dbl&gt; 2545, 2547, 5325, 6322, 6353, 7644, 8872, 9624, 10904, 1259‚Ä¶
$ temporada  &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4,‚Ä¶
$ episodio   &lt;dbl&gt; 2, 2, 10, 12, 12, 17, 21, 1, 5, 10, 12, 17, 17, 20, 22, 2, ‚Ä¶
$ cena       &lt;dbl&gt; 24, 24, 2, 33, 38, 6, 22, 49, 59, 49, 41, 9, 23, 11, 68, 6,‚Ä¶
$ fala       &lt;chr&gt; "That's what she said. Pam?", "That's what she sai [clears ‚Ä¶
$ personagem &lt;chr&gt; "Michael", "Michael", "Michael", "Dwight", "Michael", "Mich‚Ä¶
$ deletado   &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALS‚Ä¶</code></pre>
</div>
</div>
<p><strong>35 falas</strong> com ‚Äú<em>That‚Äôs what she said</em>‚Äù!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">twss <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb12-2">    <span class="fu" style="color: #4758AB;">group_by</span>(personagem) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb12-3">    <span class="fu" style="color: #4758AB;">tally</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb12-4">    <span class="fu" style="color: #4758AB;">arrange</span>(<span class="fu" style="color: #4758AB;">desc</span>(n))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 √ó 2
   personagem              n
   &lt;chr&gt;               &lt;int&gt;
 1 Michael                23
 2 Dwight                  3
 3 Creed                   1
 4 David                   1
 5 Deposition Reporter     1
 6 Everyone                1
 7 Holly                   1
 8 Jan                     1
 9 Jim                     1
10 Pam                     1
11 Stanley                 1</code></pre>
</div>
</div>
<p>Claro que quem mais falou foi o <em>Michael</em>, mas o VAR vai ser chamado pra checar esse banco de dados a√≠ üòÖ!</p>


</section>

 ]]></description>
  <category>pt-br</category>
  <category>R</category>
  <category>The Office</category>
  <category>tidyverse</category>
  <guid>https://rsilveirafh.netlify.app/posts/004-explorando-the-office/index.html</guid>
  <pubDate>Sat, 15 Oct 2022 03:00:00 GMT</pubDate>
  <media:content url="https://media.giphy.com/media/LXfpI3nNbfCm91llsA/giphy.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>A great ggplot tip!</title>
  <dc:creator>Ricardo</dc:creator>
  <link>https://rsilveirafh.netlify.app/posts/003-ggplot-tip/index.html</link>
  <description><![CDATA[ 




<section id="what-this-post-is-about" class="level2">
<h2 class="anchored" data-anchor-id="what-this-post-is-about">What this post is about?</h2>
<ul>
<li><code>ggplot2</code> tips</li>
</ul>
</section>
<section id="history" class="level2">
<h2 class="anchored" data-anchor-id="history">History</h2>
<p>Some time ago, lost through the deep arms of the internet üòé, I have found a great drawing with all the theme elements references of a plot within <code>ggplot2</code>.</p>
<p>But, as is well known, if you don‚Äôt save that, it will be lost forever.</p>
<p>Except when you have a great community on <a href="http://twitter.com/">twitter</a>, and there is a bunch of good people trying to help everyone!</p>
<p><em>Some time ahead‚Ä¶</em></p>
<p>I finally found it! Here it is:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ggplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/003-ggplot-tip/https:/isabella-b.com/blog/ggplot2-theme-elements-reference/ggplot2-theme-elements-reference-v2_hu8994090e1960a0a71878a3756da20076_580819_2000x2000_fit_lanczos_2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: ggplot2 theme elements references, by Isabella Benabaye.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>I also found the <a href="https://isabella-b.com/blog/ggplot2-theme-elements-reference/">post</a> on her blog, with better quality <a href="https://isabella-b.com/files/ggplot2-theme-elements-reference-v2.png">images</a> and/or a <a href="https://isabella-b.com/files/ggplot2-theme-elements-reference-v2.pdf">pdf</a> file.</p>
</section>
<section id="the-history-continues" class="level2">
<h2 class="anchored" data-anchor-id="the-history-continues">The history continues‚Ä¶</h2>
<p>More interesting: actually, she had her idea after this twitter post from Henry Wang:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-tweet" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/003-ggplot-tip/index_files/figure-html/fig-tweet-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Henry Wang‚Äôs tweet.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>And, he also made a nice <a href="https://henrywang.nl/ggplot2-theme-elements-demonstration/">post</a> about the subject (where you can download his version of <code>ggplot2</code> theme elements demonstration).</p>
</section>
<section id="finishing" class="level2">
<h2 class="anchored" data-anchor-id="finishing">Finishing</h2>
<p>That‚Äôs it, enjoy the creativity and good ideas from all these people, soon I‚Äôll bring some more.</p>
<p>Thanks for the reading, cheers!</p>
<ol start="18" type="A">
<li></li>
</ol>


</section>

 ]]></description>
  <category>code</category>
  <category>ggplot2</category>
  <category>R</category>
  <category>tips</category>
  <guid>https://rsilveirafh.netlify.app/posts/003-ggplot-tip/index.html</guid>
  <pubDate>Fri, 14 Oct 2022 03:00:00 GMT</pubDate>
  <media:content url="https://isabella-b.com/blog/ggplot2-theme-elements-reference/ggplot2-theme-elements-reference-v2_hu8994090e1960a0a71878a3756da20076_580819_2000x2000_fit_lanczos_2.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Drawing a star in R with ggplot</title>
  <dc:creator>Ricardo</dc:creator>
  <link>https://rsilveirafh.netlify.app/posts/002-star/index.html</link>
  <description><![CDATA[ 




<section id="what-this-post-is-about" class="level2">
<h2 class="anchored" data-anchor-id="what-this-post-is-about">What this post is about?</h2>
<ul>
<li>Drawing a star using <code>ggplot2</code> in R Language.</li>
</ul>
</section>
<section id="history" class="level2">
<h2 class="anchored" data-anchor-id="history">History:</h2>
<p>In Brazil we are about to choose the next President for the 4 years ahead.</p>
<p>I am a workers party supporter (PT, <em>Partido dos Trabalhadores</em>), with <strong><a href="https://twitter.com/LulaOficial">Lula</a></strong> as our candidate.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lula" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/lula.jpeg" class="img-fluid figure-img" width="375"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Lulinha peace and love &lt;3</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>With this being told, the PT flag is a white star in a red background, my plan is to draw this, showing all the steps to do it.</p>
</section>
<section id="hands-on" class="level2">
<h2 class="anchored" data-anchor-id="hands-on">Hands on!</h2>
<p>First of all, we will need to load <code>dplyr</code> and <code>ggplot2</code>, the package of functions that we will use in this session:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(dplyr) <span class="co" style="color: #5E5E5E;"># data wrangling</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">library</span>(ggplot2) <span class="co" style="color: #5E5E5E;"># plots</span></span></code></pre></div>
</div>
<p>Let‚Äôs start by creating our blank canvas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">ggplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/index_files/figure-html/plot01-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Blank canvas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Now we can ask to ggplot to put a void theme (without texts or axis), and then to add a red background:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">red <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ggplot</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb3-2">    <span class="fu" style="color: #4758AB;">theme_void</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb3-3">    <span class="fu" style="color: #4758AB;">theme</span>(<span class="at" style="color: #657422;">plot.background =</span> <span class="fu" style="color: #4758AB;">element_rect</span>(<span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"red"</span>))</span>
<span id="cb3-4"></span>
<span id="cb3-5">red</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/index_files/figure-html/plot02-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Red canvas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The challenge now is to draw by draft our star. First, let‚Äôs study how it is:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-star" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/star.jpg" class="img-fluid figure-img" style="width:150.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: A star and its coordinates.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>To do this, let‚Äôs create a <code>tibble</code> with the <code>x</code> and <code>y</code> coordinates (11 to close the polygon):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">r <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rep_len</span>(<span class="at" style="color: #657422;">x =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">100</span>, <span class="dv" style="color: #AD0000;">100</span> <span class="sc" style="color: #5E5E5E;">*</span> <span class="fu" style="color: #4758AB;">sin</span>(pi<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">10</span>) <span class="sc" style="color: #5E5E5E;">/</span> <span class="fu" style="color: #4758AB;">cos</span>(pi<span class="sc" style="color: #5E5E5E;">/</span><span class="dv" style="color: #AD0000;">5</span>)), </span>
<span id="cb4-2">             <span class="at" style="color: #657422;">length.out =</span> <span class="dv" style="color: #AD0000;">11</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4">star <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">tibble</span>(<span class="at" style="color: #657422;">coord =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">11</span>,</span>
<span id="cb4-5">               <span class="at" style="color: #657422;">x =</span> r <span class="sc" style="color: #5E5E5E;">*</span> <span class="fu" style="color: #4758AB;">sin</span>(<span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">2</span> <span class="sc" style="color: #5E5E5E;">*</span> pi, <span class="at" style="color: #657422;">length.out =</span> <span class="dv" style="color: #AD0000;">11</span>)),</span>
<span id="cb4-6">               <span class="at" style="color: #657422;">y =</span> r <span class="sc" style="color: #5E5E5E;">*</span> <span class="fu" style="color: #4758AB;">cos</span>(<span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">2</span> <span class="sc" style="color: #5E5E5E;">*</span> pi, <span class="at" style="color: #657422;">length.out =</span> <span class="dv" style="color: #AD0000;">11</span>)))</span>
<span id="cb4-7"></span>
<span id="cb4-8">knitr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">kable</span>(star, <span class="at" style="color: #657422;">align =</span> <span class="st" style="color: #20794D;">"c"</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: center;">coord</th>
<th style="text-align: center;">x</th>
<th style="text-align: center;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.00000</td>
<td style="text-align: center;">100.0000</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">22.45140</td>
<td style="text-align: center;">30.9017</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">95.10565</td>
<td style="text-align: center;">30.9017</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">36.32713</td>
<td style="text-align: center;">-11.8034</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">58.77853</td>
<td style="text-align: center;">-80.9017</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.00000</td>
<td style="text-align: center;">-38.1966</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">-58.77853</td>
<td style="text-align: center;">-80.9017</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">-36.32713</td>
<td style="text-align: center;">-11.8034</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">-95.10565</td>
<td style="text-align: center;">30.9017</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">-22.45140</td>
<td style="text-align: center;">30.9017</td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: center;">0.00000</td>
<td style="text-align: center;">100.0000</td>
</tr>
</tbody>
</table>
<p>Star coordinates.</p>
</div>
</div>
<p>Now, let‚Äôs include the star coordinates (and the paths) within the red plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">red <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb5-2">    <span class="fu" style="color: #4758AB;">geom_polygon</span>(<span class="at" style="color: #657422;">data =</span> star, <span class="at" style="color: #657422;">mapping =</span> <span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> x, <span class="at" style="color: #657422;">y =</span> y))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/index_files/figure-html/plot03-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Almost there.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The next step is to paint the star in white color, and also fix the coordinates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pt <span class="ot" style="color: #003B4F;">&lt;-</span> red <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-2">    <span class="fu" style="color: #4758AB;">geom_polygon</span>(<span class="at" style="color: #657422;">data =</span> star, <span class="at" style="color: #657422;">mapping =</span> <span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> x, <span class="at" style="color: #657422;">y =</span> y),</span>
<span id="cb6-3">                 <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"white"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-4">    <span class="fu" style="color: #4758AB;">coord_equal</span>()</span>
<span id="cb6-5"></span>
<span id="cb6-6">pt </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/index_files/figure-html/plot04-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">The workers party flag!</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Our PT flag is ready!</p>
<p>Just to complete, we can include the number of the party in the middle of the star, the number 13!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">pt <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb7-2">    <span class="fu" style="color: #4758AB;">annotate</span>(<span class="at" style="color: #657422;">geom =</span> <span class="st" style="color: #20794D;">"text"</span>,</span>
<span id="cb7-3">             <span class="at" style="color: #657422;">label =</span> <span class="dv" style="color: #AD0000;">13</span>,</span>
<span id="cb7-4">             <span class="at" style="color: #657422;">x =</span> <span class="sc" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">4</span>,</span>
<span id="cb7-5">             <span class="at" style="color: #657422;">y =</span> <span class="dv" style="color: #AD0000;">0</span>,</span>
<span id="cb7-6">             <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">40</span>,</span>
<span id="cb7-7">             <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/index_files/figure-html/plot05-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">It is ready!</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We have our flag!</p>
</section>
<section id="finishing" class="level2">
<h2 class="anchored" data-anchor-id="finishing">Finishing</h2>
<p>The next step is to dress all red at October 30th 2022, vote in our great eletronic voting machines, and hope for the best!</p>
<p>Make the L!</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-L" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://rsilveirafh.netlify.app/posts/002-star/L.jpg" class="img-fluid figure-img" width="640"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Faz o L!</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Cheers,</p>
<ol start="18" type="A">
<li></li>
</ol>


</section>

 ]]></description>
  <category>code</category>
  <category>ggplot2</category>
  <category>Lula</category>
  <category>PT</category>
  <category>R</category>
  <category>star</category>
  <guid>https://rsilveirafh.netlify.app/posts/002-star/index.html</guid>
  <pubDate>Thu, 13 Oct 2022 03:00:00 GMT</pubDate>
  <media:content url="https://rsilveirafh.netlify.app/posts/002-star/image.png" medium="image" type="image/png" height="107" width="144"/>
</item>
</channel>
</rss>
